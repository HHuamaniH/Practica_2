@{
    ViewBag.Title = "Informe Digital";
}
<link href="~/Areas/Fiscalizacion/css/InformeLegal/IFIDigital.css?v=1" rel="stylesheet" />
<script src="~/Scripts/vue.min.js"></script>
<script src="~/Scripts/ckeditor5/ckeditor.js"></script>
<script src="~/Scripts/jquery.tmpl.min.js"></script>
<script src="~/Scripts/jquery.googoose.js?v=8"></script>
<script src="~/Scripts/pdfjs/pdf.min.js"></script>
<script type="text/javascript">
    pdfjsLib.GlobalWorkerOptions.workerSrc = urlLocalSigo + 'Scripts/pdfjs/pdf.worker.min.js';
</script>
<script type="text/javascript">
    var documentName_ = null;
    var urlBaseDocFirma = '@System.Configuration.ConfigurationManager.AppSettings["pathInvoker"]';
    var urlBaseDocFirmaTrans = '@System.Configuration.ConfigurationManager.AppSettings["pathTransferidoSITD"]';

    function toBase() {
        $('#myTab a.nav-link[href="#navDatos"]').tab("show");
    }
</script>
<script src="~/Areas/General/js/Informes/general.js?v=1"></script>
<script src="~/Scripts/ckeditor5/config.js?v=1"></script>
<script src="~/Areas/General/js/Informes/components.js?v=1"></script>
<script src="~/Areas/Fiscalizacion/js/InformeLegal/IFI.js?noCache=@Guid.NewGuid().ToString()" type="text/javascript"></script>

<div id="frmInforme" class="card loading">
    <div id="informe_header" class="card-header text-small d-flex justify-content-between align-items-center">
        <div>Generar Informe</div>
        <div class="options">
            <button type="button" class="btn btn-link btn-sm p-0 ml-3" onclick="_informe.Exportar()" v-if="Informe.COD_INFORME_DIGITAL && Informe.ESTADO < States.FINALIZADO">
                <i class="fa fa-file-word-o fa-fw"></i>Crear informe
            </button>
            <button type="button" class="btn btn-link btn-sm p-0 ml-3" onclick="_informe.Registro()" v-if="Informe.COD_INFORME && Informe.ESTADO < States.COMPLETADO || Informe.FLG_ACTUALIZAR">
                <i class="fa fa-save fa-fw"></i>Guardar
            </button>
            <div class="btn-group" v-if="Informe.COD_INFORME_DIGITAL">
                <button type="button" class="btn btn-link btn-sm p-0 ml-3 dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Más opciones
                </button>
                <div class="dropdown-menu dropdown-menu-right">
                    <template v-if="Informe.ESTADO == States.INGRESADO">
                        <a class="dropdown-item" href="javascript:void(0);" onclick="_informe.ENVIAR_REVISION()">Enviar a revisión</a>
                    </template>
                    <template v-if="Informe.ESTADO == States.EN_REVISION">
                        <a class="dropdown-item" href="javascript:void(0);" onclick="_informe.SITD_OPEN()">Generar/Modificar expediente SITD</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="javascript:void(0);" onclick="_informe.DESCARGAR_ARCHIVO_REVISION()">Descargar documento para revisión</a>
                        <a class="dropdown-item" href="javascript:void(0);" onclick="_informe.REVISION_CARGAR_ARCHIVO()">Cargar documento revisado</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="javascript:void(0);" onclick="_informe.CERRAR()">Cerrar revisión de informe</a>
                    </template>
                    <template v-if="Informe.ESTADO == States.COMPLETADO">
                        <a class="dropdown-item" href="javascript:void(0);" onclick="_informe.CARGAR_ARCHIVO()">Cargar documento</a>
                    </template>
                    <template v-if="Informe.ESTADO == States.VISADO">
                        <a class="dropdown-item" href="javascript:void(0);" onclick="_informe.ENVIAR_CONTROL_CALIDAD()">Enviar a Control de Calidad</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="javascript:void(0);" onclick="_informe.ANULAR()">Anular firmas</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="javascript:void(0);" onclick="_informe.TRANSFERIR()">Transferir documento firmado</a>
                    </template>
                    <a class="dropdown-item" href="javascript:void(0);" v-if="Informe.ESTADO >= States.VISADO" onclick="_informe.VerDocumento()">Ver documento</a>
                </div>
            </div>
        </div>
    </div>

    <div class="stepwizard my-3" v-if="Informe.COD_INFORME_DIGITAL">
        <div class="stepwizard-row setup-panel">
            <div class="stepwizard-step" v-bind:class="{ 'active': Informe.ESTADO == States.INGRESADO }">
                <a class="btn btn-circle" v-bind:class="Informe.ESTADO == States.INGRESADO ? 'btn-success' : 'btn-secondary'">
                    <i class="fa fa-pencil"></i>
                </a>
                <p class="d-none d-sm-block">Ingresado</p>
            </div>
            <div class="stepwizard-step" v-bind:class="{ 'active': Informe.ESTADO == States.EN_REVISION }">
                <a class="btn btn-circle" v-bind:class="Informe.ESTADO == States.EN_REVISION ? 'btn-success' : 'btn-secondary'">
                    <i class="fa fa-eye"></i>
                </a>
                <p class="d-none d-sm-block">En Revisión</p>
            </div>
            <div class="stepwizard-step" v-bind:class="{ 'active': Informe.ESTADO == States.COMPLETADO }">
                <a class="btn btn-circle" v-bind:class="Informe.ESTADO == States.COMPLETADO ? 'btn-success' : 'btn-secondary'">
                    <i class="fa fa-lock"></i>
                </a>
                <p class="d-none d-sm-block">Completado</p>
            </div>
            <div class="stepwizard-step" v-bind:class="{ 'active': Informe.ESTADO == States.VISADO }">
                <div class="prevent">
                    <a class="btn btn-circle dropdown-toggle caret-off" data-display="static" data-toggle="dropdown"
                       v-bind:class="Informe.ESTADO == States.VISADO ? 'btn-success' : 'btn-secondary'">
                        <i class="fa fa-check"></i>
                    </a>
                    <p class="d-none d-sm-block">Visado</p>
                    <div class="dropdown-menu dropdown-menu-right p-3" style="min-width: 270px;">
                        <div class="row mb-3" v-for="(item, index) in Informe.PARTICIPANTES" v-if="item.flgAplica">
                            <div class="col">
                                <div>{{item.funcion}}</div>
                                <small class="person-name">{{item.apellidosNombres}}</small>
                            </div>
                            <div class="col-auto">
                                <i class="fa fa-lg" v-bind:class="{'fa-times': item.estado == 1, 'fa-envelope-o': item.estado == 2, 'fa-eye': item.estado == 3, 'fa-check': item.estado == 4}"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="stepwizard-step" v-bind:class="{ 'active': Informe.ESTADO == States.FINALIZADO }">
                <a class="btn btn-circle" v-bind:class="Informe.ESTADO == States.FINALIZADO ? 'btn-success': 'btn-secondary' ">
                    <i class="fa fa-external-link-square"></i>
                </a>
                <p class="d-none d-sm-block">Finalizado</p>
            </div>
        </div>
    </div>

    <div class="card-body" v-if="Informe.COD_INFORME">
        <fieldset class="fs-border" v-bind:disabled="Informe.ESTADO > States.EN_REVISION">
            <legend>Datos Generales</legend>
            <div class="form-row">
                <div class="col-sm-4">
                    <div class="form-group form-group-sm">
                        <label class="col-form-label text-small">Procedencia</label>
                        <select class="form-control form-control-sm" v-model="Informe.COD_PROCEDENCIA">
                            <option v-for="(item, index) in Procedencias" :value="item.COD_PROCEDENCIA">{{item.PROCEDENCIA}}</option>
                        </select>
                    </div>
                </div>
                <div class="col-sm-2">
                    <div class="form-group form-group-sm">
                        <label class="col-form-label text-small">Tipo de IFI</label>
                        <select class="form-control form-control-sm" v-model="Informe.COD_TIPO_INFORME">
                            <option value="1">Con Descargo</option>
                            <option value="2">Sin Descargo</option>
                        </select>
                    </div>
                </div>
                <div class="col-sm-4 ml-auto">
                    <div class="form-group form-group-sm text-center">
                        <label class="col-form-label text-small">N° de Informe Final de Instrucción</label>
                        <h4 class="mt-2">
                            {{Informe.NUM_INFORME_SITD || 'N/A'}} <i class="fa fa-pencil-square fa-lg ml-2 cursor-pointer text-success" v-if="Informe.COD_INFORME_DIGITAL" onclick="_informe.SITD_OPEN()"></i>
                        </h4>
                    </div>
                </div>
            </div>
            <div class="form-row">
                <div class="col-sm-2">
                    <div class="form-group form-group-sm">
                        <label class="col-form-label text-small">Materia</label>
                        <select class="form-control form-control-sm" v-on:change="MateriaOnChange()" v-model="Informe.COD_MATERIA">
                            <option v-for="(item, index) in Materias" :value="item.COD_MATERIA">{{item.MATERIA}}</option>
                        </select>
                    </div>
                </div>
                <div class="col-sm-2">
                    <div class="form-group form-group-sm">
                        <label class="col-form-label text-small">Modalidad</label>
                        <select class="form-control form-control-sm" v-model="Informe.COD_MODALIDAD">
                            <option v-for="(item, index) in Modalidades" :value="item.COD_MODALIDAD">{{item.MODALIDAD}}</option>
                        </select>
                    </div>
                </div>
                <div class="col-sm-auto">
                    <div class="form-group form-group-sm">
                        <label class="col-form-label text-small">
                            Referencia N° RSD <a class="btn btn-link btn-sm p-0 ml-2 text-success" v-on:click="AgregarRSD()" style="font-size: 0.8rem;">Agregar</a>
                        </label>
                        <div>
                            <span class="chip badge badge-success rounded mr-2 mt-1" v-for="(item, index) in Informe.RSD">
                                <a class="text-white" target="_blank" v-bind:href="_informe.ObtenerRutaResolucion(item)">{{item.numInforme}}</a>
                                <i class="fa fa-times-circle" title="Eliminar resolución" v-on:click="_informe.EliminarResolucion(item, index)"></i>
                            </span>
                            <template v-if="!Informe.RSD?.length">
                                <span class="chip badge badge-danger rounded mt-1">
                                    <i class="fa fa-info-circle"></i> No hay resoluciones asociadas
                                </span>
                            </template>
                        </div>
                    </div>
                </div>                
            </div>
            <div class="mt-1 mb-3">                
                <div class="table-responsive">
                    <table class="table table-hover table-bordered" style="margin-bottom: 0 !important;">
                        <thead>
                            <tr role="row">
                                <th colspan="100%" class="text-sm-left" rowspan="1">
                                    <div class="form-inline">
                                        <i class="fa mx-2 fa-lg fa-file-o" style="cursor:pointer;" onclick="modal_expedientes.Abrir();" v-if="Informe.ESTADO != States.FINALIZADO" data-toggle="tooltip" data-placement="top" title="Nuevo"></i>
                                        <strong>Lista de expedientes SITD</strong>
                                    </div>
                                </th>
                            </tr>
                            <tr>
                                <th style="width: 30px;" v-if="Informe.ESTADO != States.FINALIZADO"></th>
                                <th class="text-center" style="width: 30px;">N°</th>
                                <th class="text-center">GRUPO</th>
                                <th class="text-center">CÓDIGO</th>
                                <th class="text-center">NUM. DOCUMENTO</th>
                                <th class="text-center">TIPO DOCUMENTO</th>
                                <th class="text-center">DESCARGAR</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="(item, index) in Informe.EXPEDIENTES">
                                <td class="text-center" v-if="Informe.ESTADO != States.FINALIZADO">
                                    <i class="fa fa-lg fa-window-close" style="color:red;cursor:pointer;" title="Eliminar" v-on:click="_informe.fnEliminarExpediente(item, index)"></i>
                                </td>
                                <td class="text-center">{{index + 1}}</td>
                                <td class="text-center">{{item.SUBTIPO_DETALLE}}</td>
                                <td class="text-center">{{item.CODIGO}}</td>
                                <td class="text-center">{{item.NUMERO}}</td>
                                <td class="text-center">{{item.TIPO_DOCUMENTO}}</td>
                                <td class="text-center">
                                    <a href="javascript:void(0);" v-on:click="_informe.DescargarDocumentoSITD(item)" v-if="item.PDF_DOCUMENTO">Descargar</a>
                                </td>
                            </tr>
                            <tr class="odd" v-if="!Informe.EXPEDIENTES?.length">
                                <td valign="top" colspan="100" class="text-center">No existen datos registrados</td>
                            </tr>
                        </tbody>
                    </table>                    
                </div>
            </div>
            <h5>Administrado</h5>
            <div class="form-row">
                <div class="col-sm-3">
                    <div class="form-group">
                        <label class="col-form-label text-small">Nombre del titular</label>
                        <input type="text" class="form-control form-control-sm" v-model="Informe.TITULAR" disabled />
                    </div>
                </div>
                <div class="col-sm-3">
                    <div class="form-group">
                        <label class="col-form-label text-small">DNI del titular</label>
                        <input type="text" class="form-control form-control-sm" v-model="Informe.TITULAR_DOCUMENTO" disabled />
                    </div>
                </div>
                <div class="col-sm-3">
                    <div class="form-group">
                        <label class="col-form-label text-small">Representante legal</label>
                        <input type="text" class="form-control form-control-sm" v-model="Informe.R_LEGAL" disabled />
                    </div>
                </div>
                <div class="col-sm-3">
                    <div class="form-group">
                        <label class="col-form-label text-small">DNI Representante legal</label>
                        <input type="text" class="form-control form-control-sm" v-model="Informe.R_LEGAL_DOCUMENTO" disabled />
                    </div>
                </div>
            </div>
            <div class="form-row">
                <div class="col-sm-3">
                    <div class="form-group">
                        <label class="col-form-label text-small">N° contrato/permiso</label>
                        <input type="text" class="form-control form-control-sm" v-model="Informe.NUM_CONTRATO" disabled />
                    </div>
                </div>
                <div class="col-sm-3">
                    <div class="form-group">
                        <label class="col-form-label text-small">N° RUC Titular</label>
                        <div class="input-group input-group-sm">
                            <input type="text" class="form-control" v-model="Informe.TITULAR_RUC" disabled />
                            <div class="input-group-append" v-if="Informe.TITULAR_RUC">
                                <button type="button" class="btn btn-secondary" v-on:click="ConsultaRUC">
                                    <i class="fa fa-search"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-3">
                    <div class="form-group">
                        <label class="col-form-label text-small">Estado RUC Titular</label>
                        <input type="text" class="form-control form-control-sm" v-model="Informe.TITULAR_ESTADO_RUC" disabled />
                    </div>
                </div>
                <div class="col-sm-3">
                    <div class="form-group">
                        <label class="col-form-label text-small">Condición RUC Titular</label>
                        <input type="text" class="form-control form-control-sm" v-model="Informe.TITULAR_CONDICION_RUC" disabled />
                    </div>
                </div>
            </div>
            <h5>Lugar donde se registra</h5>
            <div class="form-row">
                <div class="col-sm-4">
                    <div class="form-group">
                        <label class="col-form-label text-small">Departamento</label>
                        <input type="text" class="form-control form-control-sm" v-model="Informe.UBIGEO_DEPARTAMENTO" disabled />
                    </div>
                </div>
                <div class="col-sm-4">
                    <div class="form-group">
                        <label class="col-form-label text-small">Provincia</label>
                        <input type="text" class="form-control form-control-sm" v-model="Informe.UBIGEO_PROVINCIA" disabled />
                    </div>
                </div>
                <div class="col-sm-4">
                    <div class="form-group">
                        <label class="col-form-label text-small">Distrito</label>
                        <input type="text" class="form-control form-control-sm" v-model="Informe.UBIGEO_DISTRITO" disabled />
                    </div>
                </div>
            </div>
        </fieldset>
        <fieldset class="fs-border">
            <legend>
                Control de Vistos
                <a class="ml-2 btn btn-link btn-sm" v-if="Informe.ESTADO == States.INGRESADO" onclick="_informe.Agregar_Integrante()">
                    <i class="fa fa-plus-circle mr-1"></i>Añadir un integrante
                </a>
                <a class="ml-2 btn btn-link btn-sm" v-if="Informe.ESTADO != States.FINALIZADO" v-on:click="Abrir_Notificar()">
                    <i class="fa fa-envelope-o mr-1"></i>Notificar a todos
                </a>
            </legend>
            <div class="card-view form-row align-items-end mb-3 bg-light rounded p-2 pb-3" v-for="(item, index) in Informe.PARTICIPANTES">
                <div class="col-sm-4">
                    <div class="col-form-label text-small mt-0">
                        <div class="custom-control custom-checkbox custom-control-inline" v-on:click="app.Informe.FLG_ACTUALIZAR = true">
                            <input type="checkbox" :id="'rb_' + index + '_' + index" :name="'rb' + index" v-model="item.flgAplica" class="custom-control-input"
                                   v-bind:disabled="Informe.ESTADO == States.FINALIZADO">
                            <label class="custom-control-label pt-1" :for="'rb_' + index + '_' + index">{{item.funcion}}</label>
                        </div>
                    </div>
                    <div class="input-group input-group-sm">
                        <input type="text" class="form-control form-control-sm" v-model="item.apellidosNombres" disabled />
                        <div class="input-group-append" v-if="Informe.ESTADO != States.FINALIZADO">
                            <button type="button" class="btn btn-default" v-on:click="BuscarPersona(item)">
                                <i class="fa fa-search"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="col-sm-auto">
                    <button type="button" class="btn btn-outline-primary btn-sm rounded" v-on:click="Abrir_Notificar(item)" v-bind:disabled="!item.codPersona || item.estado == 4" title="Notificar">
                        <i class="fa fa-envelope-o"></i>
                    </button>
                </div>
                <div class="col-sm pl-5 align-items-end" v-if="item.flgAplica">
                    <div class="multisteps-form__progress">
                        <button type="button" class="multisteps-form__progress-btn" v-bind:class="{'js-active': item.estado >= 1}">
                            Asignado
                        </button>
                        <button type="button" class="multisteps-form__progress-btn" v-bind:class="{'js-active': item.estado >= 2}">
                            Notificado
                        </button>
                        <button type="button" class="multisteps-form__progress-btn" v-bind:class="{'js-active': item.estado >= 3}">
                            Revisado
                        </button>
                        <button type="button" class="multisteps-form__progress-btn" v-bind:class="{'js-active': item.estado == 4}">
                            Firmado
                        </button>
                    </div>
                </div>
                <div class="col-sm-2 text-right" v-if="item.flgAplica">
                    <button type="button" class="btn btn-outline-warning btn-sm" v-on:click="Revisar(item, index)" v-if="item.estado == 2 && app.Informe.ESTADO == States.EN_REVISION">Revisar</button>
                    <button type="button" class="btn btn-primary btn-sm" v-on:click="Firmar(item, index)" v-if="item.estado >= 2" v-bind:disabled="item.estado == 4">Firmar</button>
                </div>
                <div class="options" v-if="index > 3 && Informe.ESTADO == States.INGRESADO">
                    <i class="fa fa-times-circle fa-lg text-danger cursor-pointer" v-on:click="Eliminar_Integrante(item, index)"></i>
                </div>
            </div>
        </fieldset>

        <fieldset class="fs-border" v-if="Informe.DOCUMENTOS.length">
            <legend>Documentos asociados</legend>
            <div class="form-row">
                <div class="col-sm-3" v-for="(item, index) in Informe.DOCUMENTOS">
                    <div class="file-attach">
                        <div class="file-attach-icon">
                            <i class="fa fa-file-pdf-o fa-2x"></i>
                        </div>
                        <div class="file-attach-info">
                            <a class="file-attach-name" target="_blank" v-bind:href="item.url" :title="item.nombre">{{item.nombre}}</a>
                            <div class="file-attach-details">
                                {{item.tipo}}
                            </div>
                            <span class="file-attach-remove" v-on:click="Eliminar_Archivo(item, index)"
                                  v-if="Informe.ESTADO == States.INGRESADO">&times;</span>
                        </div>
                    </div>
                </div>
            </div>
        </fieldset>

        <fieldset class="fs-border">
            <legend>Análisis</legend>
            <div class="mb-3">
                <h5>Cuestión previa: Rectificación de error material</h5>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="rb_cuestion_previa" id="rb_cuestion_previa_si" v-bind:value="true" v-model="Informe.FLG_CUESTION_PREVIA">
                    <label class="form-check-label" for="rb_cuestion_previa_si">Si</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="rb_cuestion_previa" id="rb_cuestion_previa_no" v-bind:value="false" v-model="Informe.FLG_CUESTION_PREVIA">
                    <label class="form-check-label" for="rb_cuestion_previa_no">No</label>
                </div>
            </div>
            <div class="mb-3">
                <h5>Reconocimiento de responsabilidad</h5>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="rb_reconocimiento_resp" id="rb_reconocimiento_resp_si" v-bind:value="true" v-model="Informe.FLG_REC_RESPONSABILIDAD">
                    <label class="form-check-label" for="rb_reconocimiento_resp_si">Si</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="rb_reconocimiento_resp" id="rb_reconocimiento_resp_no" v-bind:value="false" v-model="Informe.FLG_REC_RESPONSABILIDAD">
                    <label class="form-check-label" for="rb_reconocimiento_resp_no">No</label>
                </div>
            </div>
            <div class="mb-3" v-if="Informe.INFRACCIONES.length">
                <h4>Infracciones</h4>
                <ol style="list-style-type: lower-alpha">
                    <li v-for="(item, index) in Informe.INFRACCIONES">
                        <div class="card card-body border mb-2 bg-light">
                            <div><strong>Inciso {{item.inciso}}.</strong> {{item.titulo || 'No se encontró información de la infracción'}}</div>
                            <div class="small text-muted mt-2" v-if="item.detalle">{{item.detalle}}</div>
                            <div class="mt-3">
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" v-bind:name="'rb_desvirtua_'+index" v-bind:id="'rb_desvirtua_si_'+index" v-bind:value="true" v-model="item.flgDesvirtua">
                                    <label class="form-check-label" v-bind:for="'rb_desvirtua_si_'+index">Desvirtúa</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" v-bind:name="'rb_desvirtua_'+index" v-bind:id="'rb_desvirtua_no_'+index" v-bind:value="false" v-model="item.flgDesvirtua">
                                    <label class="form-check-label" v-bind:for="'rb_desvirtua_no_'+index">No desvirtúa</label>
                                </div>
                                <template v-if="['1','2','10','11','13'].includes(item.inciso)">
                                    <div class="form-check form-check-inline ml-4">
                                        <input class="form-check-input" type="radio" v-bind:name="'rb_subsana_'+index" v-bind:id="'rb_subsana_si_'+index" v-bind:value="true" v-model="item.flgSubsana">
                                        <label class="form-check-label" v-bind:for="'rb_subsana_si_'+index">Subsana</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" v-bind:name="'rb_subsana_'+index" v-bind:id="'rb_subsana_no_'+index" v-bind:value="false" v-model="item.flgSubsana">
                                        <label class="form-check-label" v-bind:for="'rb_subsana_no_'+index">No subsana</label>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </li>
                </ol>
            </div>
            <div class="mb-3">
                <h5>Determinación de la gravedad y/o riesgo generado</h5>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="rb_det_riesgo" id="rb_det_riesgo_si" v-bind:value="true" v-model="Informe.FLG_GRAVEDAD_RIESGO">
                    <label class="form-check-label" for="rb_det_riesgo_si">Si</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="rb_det_riesgo" id="rb_det_riesgo_no" v-bind:value="false" v-model="Informe.FLG_GRAVEDAD_RIESGO">
                    <label class="form-check-label" for="rb_det_riesgo_no">No</label>
                </div>
            </div>
            <div class="mb-3">
                <h5>Sobre la imposición de sanción</h5>
                <div class="row align-items-center">
                    <div class="col-auto">
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="rb_calculo_multa" id="rb_calculo_multa_si" v-bind:value="true" v-model="Informe.FLG_SANCION">
                            <label class="form-check-label" for="rb_calculo_multa_si">Si</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="rb_calculo_multa" id="rb_calculo_multa_no" v-bind:value="false" v-model="Informe.FLG_SANCION">
                            <label class="form-check-label" for="rb_calculo_multa_no">No</label>
                        </div>
                    </div>
                    <template v-if="Informe.FLG_SANCION">
                        <div class="col-auto">
                            <div class="btn-group btn-group-sm">
                                <button type="button" class="btn btn-info btn-sm" v-on:click="_informe.AbrirCalculoMulta()">
                                    {{Informe.SANCION_COD_CALCULO ? 'Editar': 'Generar'}} cálculo de multa
                                </button>
                                <template v-if="Informe.SANCION_COD_CALCULO">
                                    <button type="button" class="btn btn-default btn-sm" title="Eliminar" v-on:click="_informe.EliminarArchivoSancion()">
                                        <i class="fa fa-trash"></i>
                                    </button>
                                </template>
                            </div>
                        </div>
                        <div class="col-auto">
                            <div class="input-group input-group-sm">
                                <input type="number" class="form-control" v-model="Informe.SANCION_UIT" />
                                <div class="input-group-append">
                                    <span class="input-group-text">UIT</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-auto" v-if="Informe.SANCION_COD_CALCULO">
                            <span class="btn btn-success btn-sm">
                                <a class="text-white" target="_blank" v-bind:href="_informe.UrlDescargarArchivoSancion()">DESCARGAR CÁLCULO DE MULTA</a>
                            </span>
                        </div>
                    </template>
                </div>
            </div>
            <div class="mb-3">
                <h5>De la medida correctiva a disponerse</h5>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="rb_medida_correctiva" id="rb_medida_correctiva_si" v-bind:value="true" v-model="Informe.FLG_MEDIDA_CORRECTIVA">
                    <label class="form-check-label" for="rb_medida_correctiva_si">Si</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="rb_medida_correctiva" id="rb_medida_correctiva_no" v-bind:value="false" v-model="Informe.FLG_MEDIDA_CORRECTIVA">
                    <label class="form-check-label" for="rb_medida_correctiva_no">No</label>
                </div>
            </div>
            <div class="mb-3">
                <h5>De la medida complementaria a disponerse</h5>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="rb_medida_complementaria" id="rb_medida_complementaria_si" v-bind:value="true" v-model="Informe.FLG_MEDIDA_COMPLEMENTARIA">
                    <label class="form-check-label" for="rb_medida_complementaria_si">Si</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="rb_medida_complementaria" id="rb_medida_complementaria_no" v-bind:value="false" v-model="Informe.FLG_MEDIDA_COMPLEMENTARIA">
                    <label class="form-check-label" for="rb_medida_complementaria_no">No</label>
                </div>
            </div>
            <div class="mb-3">
                <h5>Responsable solidario</h5>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="rb_responsable_solid" id="rb_responsable_solid_si" v-bind:value="true" v-model="Informe.FLG_RESP_SOLIDARIO">
                    <label class="form-check-label" for="rb_responsable_solid_si">Si</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="rb_responsable_solid" id="rb_responsable_solid_no" v-bind:value="false" v-model="Informe.FLG_RESP_SOLIDARIO">
                    <label class="form-check-label" for="rb_responsable_solid_no">No</label>
                </div>
            </div>
            <div class="mb-3">
                <h5>Comunicación al GORE</h5>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="rb_comunicacion_gore" id="rb_comunicacion_gore_si" v-bind:value="true" v-model="Informe.FLG_COMUNICACION_GORE">
                    <label class="form-check-label" for="rb_comunicacion_gore_si">Si</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="rb_comunicacion_gore" id="rb_comunicacion_gore_no" v-bind:value="false" v-model="Informe.FLG_COMUNICACION_GORE">
                    <label class="form-check-label" for="rb_comunicacion_gore_no">No</label>
                </div>
            </div>
        </fieldset>
    </div>
    <div class="py-5 my-3 text-center" v-else>
        <h4>Para registrar el IFI Digital, primero genere la sección de "Datos Generales"</h4>
        <p>Especifique los documentos que serán tomados como referencia (Informes, Expedientes, ...), luego guarde el informe.</p>
        <a class="btn btn-link" onclick="toBase()">Aceptar</a>
    </div>
</div>

<div id="modal-rsd" class="modal fade" data-backdrop="static">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header text-small" style="cursor:move;">
                <span>Buscar Resolución Sub Directoral</span>
                <i class="fa fa-close" style="cursor:pointer;" data-dismiss="modal" aria-label="Close"></i>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="col-form-label col-form-label-sm">Buscar</label>
                    <div class="input-group">
                        <select class="form-control form-control-sm col-3" v-model="opcion">
                            <option v-bind:value="item.Value" v-for="(item, index) in opciones">{{item.Text}}</option>
                        </select>
                        <input type="text" class="form-control form-control-sm" v-model="texto" v-on:keyup.enter="Buscar()" />
                        <div class="input-group-btn">
                            <button type="button" class="btn btn-primary btn-sm" v-on:click="Buscar()">
                                <i class="fa fa-search"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="table-responsive">
                    <table id="dt_rsd" class="table table-bordered table-hover"></table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Cancelar</button>
            </div>
        </div>
    </div>
</div>

<div id="modal-integrante" class="modal fade" data-backdrop="static">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header text-small" style="cursor:move;">
                <span>Nuevo integrante</span>
                <i class="fa fa-close" style="cursor:pointer;" data-dismiss="modal" aria-label="Close"></i>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="col-form-label col-form-label-sm">Función</label>
                    <select class="form-control form-control-sm" v-model="form.funcion">
                        <option>Especialista Legal</option>
                        <option>Ingeniero Forestal</option>
                        <option>Coordinador</option>
                        <option>Subdirector</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="col-form-label col-form-label-sm">Apellidos y Nombres</label>
                    <div class="input-group input-group-sm">
                        <input type="text" class="form-control form-control-sm" v-model="form.apellidosNombres" disabled />
                        <div class="input-group-append">
                            <button type="button" class="btn btn-default" v-on:click="app.BuscarPersona(form)">
                                <i class="fa fa-search"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary btn-sm" v-on:click="Agregar" v-bind:disabled="!form.funcion">Aceptar</button>
                <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Cancelar</button>
            </div>
        </div>
    </div>
</div>

<div id="modal-notificar" class="modal fade" data-backdrop="static">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header text-small" style="cursor:move;">
                <span>Notificación</span>
                <i class="fa fa-close" style="cursor:pointer;" data-dismiss="modal" aria-label="Close"></i>
            </div>
            <div class="modal-body">
                <div class="row align-items-start mb-2">
                    <div class="col-auto">
                        <span class="col-form-label col-form-label-sm">Destinatarios</span>
                    </div>
                    <div class="col">
                        <div class="form-check form-check-inline mb-3" v-for="(item, index) in form.Destinatarios">
                            <input class="form-check-input" type="checkbox" :id="'cb_'+ index" :value="item" v-model="form.Seleccionados" checked>
                            <label class="form-check-label mt-0" :for="'cb_'+ index">{{item.email}}</label>
                        </div>
                        <span class="small" v-if="!form.Destinatarios.length">
                            No hay destinatarios disponibles
                        </span>
                    </div>
                </div>
                <div class="mb-3">
                    <input type="text" class="form-control" placeholder="C.C." v-model="form.CC" />
                </div>
                <editor v-model="form.Mensaje"></editor>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary btn-sm" v-on:click="Notificar" v-bind:disabled="!form.Seleccionados.length">Notificar</button>
                <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Cancelar</button>
            </div>
        </div>
    </div>
</div>

<div id="modal-sitd" class="modal fade" data-backdrop="static">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header text-small" style="cursor:move;">
                <span>SITD</span>
                <i class="fa fa-close" style="cursor:pointer;" data-dismiss="modal" aria-label="Close"></i>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="col-form-label">Oficinas</label>
                            <select class="form-control form-control-sm" v-model="form.iCodOficina" @@change="_informe.SITD_TrabajadoresXOficina()" v-bind:disabled="form.iCodTramite">
                                <option v-for="option in oficinas" v-bind:value="option.Value">
                                    {{ option.Text }}
                                </option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-8">
                        <div class="form-group">
                            <label class="col-form-label">Trabajador</label>
                            <select class="form-control form-control-sm" v-model="form.trabajadorId" v-bind:disabled="form.iCodTramite">
                                <option v-for="option in trabajadores" v-bind:value="option.trabajadorId">
                                    {{ option.nombres }} {{ option.apellidos }}
                                </option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="col-form-label">Tipo de Documento</label>
                            <select class="form-control form-control-sm" v-model="form.cCodTipoDoc" v-bind:disabled="form.iCodTramite">
                                <option v-for="option in documentos" v-bind:value="option.Value">
                                    {{ option.Text }}
                                </option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="col-form-label">Fecha de Registro</label>
                            <div class="input-group input-group-sm">
                                <date-picker v-model="form.fechaRegistro" :disabled="form.iCodTramite"></date-picker>
                                <div class="input-group-append">
                                    <div class="input-group-text">
                                        <i class="fa fa-calendar"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-form-label">Referencias (Expedientes SITD):</label>
                    <div>
                        <span class="chip badge badge-success rounded mr-2 mt-1" v-for="(item, index) in app.Informe.EXPEDIENTES">
                            {{item.CODIGO}}
                        </span>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-form-label">Asunto</label>
                    <textarea class="form-control form-control-sm" rows="3" v-model="form.cAsunto"></textarea>
                </div>
                <div class="form-group">
                    <label class="col-form-label">Observaciones</label>
                    <textarea class="form-control form-control-sm" rows="3" v-model="form.cObservaciones"></textarea>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="col-form-label">Folios</label>
                            <input type="text" class="form-control form-control-sm" v-model="form.cnNumFolio" />
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="col-form-label">Indicación</label>
                            <select class="form-control form-control-sm" v-model="form.indicacionId" v-bind:disabled="form.iCodTramite">
                                <option v-for="option in indicaciones" v-bind:value="option.Value">
                                    {{ option.Text }}
                                </option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="col-form-label">Prioridad</label>
                            <select class="form-control form-control-sm" v-model="form.prioridad" v-bind:disabled="form.iCodTramite">
                                <option v-for="option in prioridades" v-bind:value="option.Value">
                                    {{ option.Text }}
                                </option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary btn-sm" v-on:click="_informe.SITD_Registro()">Guardar</button>
                <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Cancelar</button>
            </div>
        </div>
    </div>
</div>

<div id="modal-cargar-documento" class="modal fade" data-backdrop="static">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header text-small" style="cursor:move;">
                <span>Cargar documento</span>
                <i class="fa fa-close" style="cursor:pointer;" data-dismiss="modal" aria-label="Close"></i>
            </div>
            <div class="modal-body" v-on:dragover="dragOver" v-on:dragleave="dragLeave" v-on:drop="drop">
                <div class="p-3 text-center text-muted" v-if="!file" v-on:click="fileSearch($event)">
                    <i class="fa fa-cloud-upload fa-4x text-info"></i>
                    <div class="small">Arrastre un archivo o haga clic aquí para cargar uno</div>
                </div>
                <div class="p-3" v-else>
                    <div class="row">
                        <div class="col-auto">
                            <i class="fa fa-cloud-upload fa-5x text-success"></i>
                        </div>
                        <div class="col">
                            <h3>Información del archivo</h3>
                            <div class="mb-2">{{info.name}}</div>
                            <div><b>Tamaño:</b> {{info.sizeFormat}}</div>
                            <div><b>Tipo:</b> {{info.type}}</div>
                            <div class="mt-3" v-if="!loading">
                                <a class="btn btn-link btn-sm p-0" v-on:click="fileSearch($event)">
                                    <i class="fa fa-cloud-upload"></i> Cambiar archivo...
                                </a>
                            </div>
                            <div class="text-center mt-3" v-else-if="loading">
                                <div class="mt-3 mb-1 small">Cargando {{percent}}%</div>
                                <div class="progress">
                                    <div class="progress-bar" role="progressbar" v-bind:style="{width: percent + '%'}" v-bind:aria-valuenow="percent" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <div>
                                    <a class="btn btn-link btn-sm" v-on:click="cancel">Cancelar</a>
                                </div>
                            </div>
                            <div class="mt-3 text-success" v-if="!loading && !error && percent == 100">
                                ¡El archivo se ha cargado exitosamente!
                            </div>
                            <div class="mt-3 alert alert-danger" v-if="error">
                                Hubo un problema al cargar el archivo
                            </div>
                        </div>
                    </div>
                </div>
                <div class="d-none">
                    <input type="file" v-bind:accept="accept.join(',')" v-on:change="fileChange" />
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary btn-sm" v-on:click="upload" v-if="file && !loading && percent !== 100">Cargar</button>
                <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Salir</button>
            </div>
        </div>
    </div>
</div>

<div id="modal-expedientes" class="modal fade" data-backdrop="static">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header text-small" style="cursor:move;">
                <span>Expedientes SITD</span>
                <i class="fa fa-close" style="cursor:pointer;" data-dismiss="modal" aria-label="Close"></i>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="col-md-auto mb-3">
                        <label class="control-label small">Grupo</label>
                        <select class="form-control form-control-sm" v-model="subtipo">
                            <option v-for="item in subtipos" v-bind:value="item.SUBTIPO">{{item.DESCRIPCION}}</option>
                        </select>
                    </div>
                    <div class="col-md-3 mb-3">
                        <label class="control-label small">Filtrar por</label>
                        <select class="form-control form-control-sm" v-model="filtro">
                            <option value="CNRODOCUMENTO">Nro Documento</option>
                            <option value="CCODIFICACION">Codigo Asignado</option>
                        </select>
                    </div>
                    <div class="col-md mb-3">
                        <label class="control-label small">&nbsp;</label>
                        <div class="input-group input-group-sm">
                            <input type="text" class="form-control form-control-sm" maxlength="50" v-model="texto" v-on:keyup.enter="Buscar()" />
                            <div class="input-group-btn">
                                <button type="button" class="btn btn-outline-success btn-sm" v-on:click="Buscar()">
                                    <i class="fa fa-search" data-toggle="tooltip" data-placement="top" title="Buscar"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="table-responsive">
                    <table id="dtExpedientes" class="table table-hover table-bordered w-100">
                        <thead></thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Salir</button>
            </div>
        </div>
    </div>
</div>

<div id="partialviews"></div>
